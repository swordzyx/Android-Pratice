package blog.zero.com.androidipc_yg.sharedbyfile;

import android.content.Intent;
import android.os.Bundle;
import android.view.View;

import androidx.appcompat.app.AppCompatActivity;

import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.ObjectOutputStream;

import blog.zero.com.androidipc_yg.Messenger.MessageActivity;
import blog.zero.com.androidipc_yg.R;
import blog.zero.com.androidipc_yg.SerialzableEntity.User;
import blog.zero.com.androidipc_yg.util.Consts;

public class MainActivity extends AppCompatActivity implements View.OnClickListener {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    public void persistToFile(){
        new Thread(){
            @Override
            public void run(){
                File dir = new File(Consts.CACHE_2_FILE);
                if (!dir.exists()){
                    dir.mkdirs();
                }
                File cacheFile = new File(Consts.CACHE_FILE);
                ObjectOutputStream outputStream = null;
                try {
                    outputStream = new ObjectOutputStream(new FileOutputStream(cacheFile));
                    User user = new User(1, "zero", false);
                    outputStream.writeObject(user);
                } catch (IOException e) {
                    e.printStackTrace();
                } finally{
                    try {
                        if (outputStream != null){
                            outputStream.close();
                        }
                    } catch (IOException e) {
                        e.printStackTrace();
                    }
                }
            }

        }.start();
    }

    @Override
    public void onClick(View view) {
        switch (view.getId()){
            case R.id.messenger:
                Intent intent = new Intent(MainActivity.this, MessageActivity.class);
                startActivity(intent);
                break;
        }
    }
}
